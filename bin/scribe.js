(function(){var f=window.modules||[],c=null;f.scribe__datastore=function(){if(null===c){var b,f,h;b=require("scribe/repositories/entity_container");f=require("scribe/factory/entity_factory");h=require("scribe/factory/reference_builder");var a=function(a,e){this.entityFactory=a;this.entityContainer=e};a.create=function(a,e){var g;null==e&&(e=[]);g=new b;return new this(new f(new h(g),a,e),g)};a.prototype.buildEntity=function(a,e){return this.entityContainer.add(this.entityFactory.build(a,e))};a.prototype.buildEntities=
function(a,e){var g,h,c,b;b=[];h=0;for(c=e.length;h<c;h++)g=e[h],b.push(this.buildEntity(a,g));return b};a.prototype.getRepository=function(a){return this.entityContainer.getRepository(a)};a.prototype.find=function(a,e){return this.entityContainer.find(a,e)};c=a}return c};window.modules=f})();
(function(){var f=window.modules||[],c=null;f.scribe__factory__auto_mapper=function(){if(null===c){var b=function(e,a){this.entityClass=e;this.referenceBuilder=null!=a?a:null},f,h,a,d;b.prototype.canHandle=function(e){return e===this.entityClass.name};b.prototype.handle=function(e){var a;a=d.call(this,e);"function"===typeof this.buildEntity&&this.buildEntity(e,a);this.referenceBuilder.hydrateReferencesFor(a);return a};d=function(e){var g,d,c,b;g=new this.entityClass(e.id);for(d in e)b=e[d],f(g,d)&&
(a(b)?this.referenceBuilder.createReference(g,d,b["class"],b.id):h(b)?(c="id"in b?b.id:b.ids,this.referenceBuilder.createReferenceCollection(g,d,b["class"],c)):g[d]=b);return g};f=function(a,d){return d in a&&!(a[d]instanceof Function)};a=function(a){return a instanceof Object&&"class"in a&&"id"in a&&!(a.id instanceof Array)};h=function(a){return a instanceof Object&&"class"in a&&("ids"in a||"id"in a&&a.id instanceof Array)};c=b}return c};window.modules=f})();
(function(){var f=window.modules||[],c=null;f.scribe__factory__entity_factory=function(){if(null===c){var b;b=require("scribe/factory/auto_mapper");var f=function(a,d,e){var g,c;this.referenceBuilder=a;null==e&&(e=[]);g=0;for(c=d.length;g<c;g++)a=d[g],h(a)&&(a.referenceBuilder=this.referenceBuilder);this.mappers=d;a=0;for(g=e.length;a<g;a++)d=e[a],this.mappers.push(new b(d,this.referenceBuilder))},h;f.prototype.build=function(a,d){var e,b,c,h;h=this.mappers;b=0;for(c=h.length;b<c;b++)if(e=h[b],e.canHandle(a))return e.handle(d);
return null};h=function(a){return a instanceof b&&null==a.referenceBuilder};c=f}return c};window.modules=f})();
(function(){var f=window.modules||[],c=null;f.scribe__factory__reference_builder=function(){if(null===c){var b=function(a){this.entityContainer=a;this.pendingReferences=[]},f,h,a,d,e,g,j,n,p;b.prototype.createReference=function(d,b,c,h){var g;g=e.call(this,c,h);return null!=g?d[b]=g:a.call(this,d,b,c,h)};b.prototype.createReferenceCollection=function(d,b,c,g){var f,l,j,m,k;k=[];j=0;for(m=g.length;j<m;j++)f=g[j],l=e.call(this,c,f),null!=l?k.push(h(d,b,l)):k.push(a.call(this,d,b,c,f,!0));return k};
b.prototype.hydrateReferencesFor=function(a){var e,b,c,h,g;e=d.call(this,a.constructor.name,a.id);g=[];c=0;for(h=e.length;c<h;c++)b=e[c],n(b,a),g.push(j.call(this,b));return g};e=function(a,e){var d;return null!=(d=this.entityContainer.getRepository(a))?d.find(e):void 0};a=function(a,e,d,b,c){null==c&&(c=!1);return this.pendingReferences.push(new f(a,e,d,b,c))};d=function(a,e){var d,b,c,h,f;h=this.pendingReferences;f=[];b=0;for(c=h.length;b<c;b++)d=h[b],g(d,a,e)&&f.push(d);return f};j=function(a){return this.pendingReferences.splice(this.pendingReferences.indexOf(a),
1)};g=function(a,d,e){return a.refClass===d&&a.refId===e};n=function(a,d){return a.partOfCollection?h(a.entity,a.prop,d):a.entity[a.prop]=d};h=function(a,d,e){var b;b=p(d);return null!=a["addTo"+b]?a["addTo"+b](e):a[d].push(e)};p=function(a){return""+a.charAt(0).toUpperCase()+a.slice(1)};f=function(a,d,e,b,c){this.entity=a;this.prop=d;this.refClass=e;this.refId=b;this.partOfCollection=null!=c?c:!1};c=b}return c};window.modules=f})();
(function(){var f=window.modules||[],c=null;f.scribe__repositories__entity_container=function(){if(null===c){var b;b=require("scribe/repositories/entity_repository");var f=function(){this.repositories=[]},h;f.prototype.add=function(a){var d;d=this.getRepository(a);null==d&&(d=h.call(this,a));return d.add(a)};f.prototype.find=function(a,d){var e;e=this.getRepository(a);return null!=e?e.find(d):null};f.prototype.getRepository=function(a){var d,e,b,c;c=this.repositories;e=0;for(b=c.length;e<b;e++)if(d=
c[e],d.canHandle(a))return d;return null};h=function(a){a=new b(a.constructor);this.repositories.push(a);return a};c=f}return c};window.modules=f})();
(function(){var f=window.modules||[],c=null;f.scribe__repositories__entity_repository=function(){if(null===c){var b=function(b){this.entityClass=b;this.entityList=[]},f;b.prototype.canHandle=function(b){return this.entityClass===b||this.entityClass.name===b||b.constructor===this.entityClass};b.prototype.add=function(b){return this.entityList.push(b)};b.prototype.remove=function(b){return this.entityList.splice(this.entityList.indexOf(b),1)};b.prototype.find=function(b){var a,d,e,c;c=this.entityList;
d=0;for(e=c.length;d<e;d++)if(a=c[d],a.id===b)return a;return null};b.prototype.findAll=function(){return this.entityList};b.prototype.findBy=function(b){var a,d,e,c,j;c=this.entityList;j=[];d=0;for(e=c.length;d<e;d++)a=c[d],f(a,b)&&j.push(a);return j};b.prototype.findOneBy=function(b){var a,d,c,g;g=this.entityList;d=0;for(c=g.length;d<c;d++)if(a=g[d],f(a,b))return a;return null};b.prototype.numEntities=function(){return this.entityList.length};f=function(b,a){var c,e;for(c in a)if(e=a[c],b[c]!==
e)return!1;return!0};c=b}return c};window.modules=f})();(function(){var f=window.modules||[];window.require=function(c){c=c.replace(/\//g,"__");-1===c.indexOf("__")&&(c="__"+c);return null===f[c]?null:f[c]()}})();

